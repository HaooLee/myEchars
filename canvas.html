<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
  <style>
    #test{
      width: 100%;
      height:400px;
      border:1px solid;
    }
  </style>
</head>
<body>
<div id="test"></div>


</body>

<script>
!function (window) {
  /**
   *
   * @param option
   * @constructor
   * option = {
   * el:这个图表嵌入哪个元素中
   * type：画什么图
   * data : {
   *  title: {
   *    bigTitle:{
   *      color:red
   *      text :''
   *    }
   *    yTitle:""
   *    xTitle:""
   *  }
   *  lineStyle:{
   *    color:
   *    width:
   *  }
   *  data: {
   *
   *  }
   *
   * }
   *
   * }
   *
   */

  window.myEchars = function(option) {
    this.option = option
    this.parentEl = document.getElementById(option.el)
    this.cvs = document.createElement('canvas')
    this.cvs.width = this.parentEl.clientWidth
    this.cvs.height = this.parentEl.clientHeight
    var me = this
    window.onresize = function () {
      console.log("resize")
      me.cvs.width = me.parentEl.clientWidth
      me.cvs.height = me.parentEl.clientHeight
    }
    this.parentEl.innerHTML = ""
    this.parentEl.appendChild(this.cvs)
    this.cvs.ondblclick=function () {

    }
    this.ctx = this.cvs.getContext('2d')
//    this.timer = setInterval(function () {
//      this.clear()
//      this[option.type] && this[option.type](option.data)
//
//    }.bind(this),)
    this[option.type] && this[option.type](option.data)

  }

  myEchars.prototype = {
    lineChart:function (data) {
      //console.log('lineChart')
      var ctx = this.ctx
      //绘制大标题
      ctx.font = "30px 微软雅黑"
      ctx.fillStyle = data.title && data.title.bigTitle && data.title.bigTitle.color || '#000'
      ctx.fillText(data.title && data.title.bigTitle && data.title.bigTitle.text || "", this.cvs.width/10,this.cvs.height/10)
      //绘制X小标题
      ctx.font = "18px 微软雅黑"
      ctx.fillStyle = data.title && data.title.xTitle && data.title.xTitle.color || '#000'
      ctx.fillText(data.title && data.title.xTitle && data.title.xTitle.text || "", this.cvs.width*0.11,this.cvs.height*0.17)
      //绘制Y小标题

      ctx.fillStyle = data.title && data.title.yTitle && data.title.yTitle.color || '#000'
      ctx.fillText(data.title && data.title.yTitle && data.title.yTitle.text || "", this.cvs.width*0.91,this.cvs.height*0.91)
      //绘制xy轴

      ctx.beginPath()
      ctx.strokeStyle = this.option.lineStyle&&this.option.lineStyle.color || "#000"
      ctx.lineWidth = this.option.lineStyle&&this.option.lineStyle.width || 2
      ctx.moveTo(this.cvs.width*0.1,this.cvs.height*0.15)
      ctx.lineTo(this.cvs.width*0.1,this.cvs.height*0.9)
      ctx.lineTo(this.cvs.width*0.9,this.cvs.height*0.9)
      ctx.stroke()
      //y 75%
      //x 80%
      //开始绘制数据
      ctx.translate(this.cvs.width*0.1,this.cvs.height*0.9)
      ctx.beginPath()
      ctx.moveTo(0,0)
      data.data && data.data.forEach(function (item, index) {
        var length = data.data.length
        var lineY = this.cvs.height * 0.75
        var lineX = this.cvs.width * 0.8
        if (!Object.is(Number(item),NaN)) {
            ctx.lineTo(lineX * index/(length-1), -lineY * item/(data.yDataScope || 100))
        }
        console.log(item)
      },this)
      ctx.lineTo(this.cvs.width*0.8,0)
      ctx.strokeStyle = data.lineStyle && data.lineStyle.color || "#000"
      ctx.fillStyle = 'rgba(0,0,255,0.5)'
      ctx.lineWidth = data.lineStyle && data.lineStyle.width || 2
      ctx.lineJoin="round"
      ctx.stroke()
      ctx.fill()
      ctx.translate(-this.cvs.width*0.1,-this.cvs.height*0.9)
    },
    clear :function () {
      this.ctx.clearRect(0,0,this.cvs.width,this.cvs.height)
    }
  }


}(window)



  new myEchars({
    el: 'test',
    type: 'lineChart',
    lineStyle:{
      color:"green",
      width:1
    },
    data: {
      title:{
        bigTitle:{
          color:'red',
          text :'我是大标题'
        },
        xTitle:{
          color:"blue",
          text:'我是X轴'
        },
        yTitle:{
          color:"blue",
          text:'我是Y轴'
        }
      },
      lineStyle:{
        color:"green",
        width:2
      },
      yDataScope:100,
      step: 10,
      data:(function () {
        var arr = []
        for (var i = 0; i<20; i++){
          arr.push(Math.random()*100 | 0)
        }
        return arr
      })()
    }
  })

</script>

</html>
